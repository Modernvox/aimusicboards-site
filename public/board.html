<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Board • AI Music Boards</title>
<link rel="icon" href="/favicon.ico?v=2" sizes="any">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png?v=2">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png?v=2">
<link rel="apple-touch-icon" href="/apple-touch-icon.png?v=2">
<link rel="manifest" href="/site.webmanifest?v=2">

  <style>
    body{background:#0b0b0f;color:#fff;font-family:Inter,system-ui,Arial;margin:0}
    .wrap{max-width:980px;margin:40px auto;padding:16px}
    .card{background:rgba(255,255,255,.06);border:1px solid rgba(255,255,255,.14);border-radius:16px;padding:18px}
    table{width:100%;border-collapse:collapse}
    th,td{padding:10px;border-bottom:1px solid rgba(255,255,255,.12);text-align:left}
    a{color:#d4af37;text-decoration:none}
    .muted{color:rgba(255,255,255,.7)}
  </style>
</head>
<body>
<div class="wrap">
  <div class="card">
    <h1>AI Music Authority Board</h1>
    <p class="muted">Only tracks scoring 30+ make the board. Ranked by score.</p>
    <table>
      <thead>
        <tr>
          <th>#</th><th>Artist</th><th>Track</th><th>Score</th><th>Listen</th>
        </tr>
      </thead>
      <tbody id="rows">
        <tr><td colspan="5" class="muted">Loading…</td></tr>
      </tbody>
    </table>
  </div>
</div>

<script>
async function load() {
  const r = await fetch("/api/board", { cache: "no-store" });
  const j = await r.json();
  const rows = document.getElementById("rows");
  rows.innerHTML = "";

  (j.items || []).forEach((it, idx) => {
    const tr = document.createElement("tr");
    tr.innerHTML = `
      <td>${idx+1}</td>
      <td>${escapeHtml(it.artist_name)}</td>
      <td>${escapeHtml(it.track_title)}</td>
      <td><b>${it.total}</b></td>
      <td><a href="${it.track_url}" target="_blank" rel="noopener">Play</a></td>
    `;
    rows.appendChild(tr);
  });

  if (!j.items || j.items.length === 0) {
    rows.innerHTML = `<tr><td colspan="5" class="muted">No approved tracks yet.</td></tr>`;
  }
}

function escapeHtml(s){
  return String(s).replace(/[&<>"']/g, m => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#039;'}[m]));
}

load();
setInterval(load, 5000);
</script>
</body>
</html>
